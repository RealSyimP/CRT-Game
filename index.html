<!DOCTYPE html>
<html>
<head>
  <title>CRT Game</title>
</head>
<body>
  <h1>CRT Game</h1>

  <p>
    x ≡ a (mod p)<br>
    x ≡ b (mod q)<br>
    について、a,bが与えられるのでxを求めてください。<br>
    なお、a,bはそれぞれ5のn乗,2のn乗です。
  </p>

  <form onsubmit="return generateRandomX(event)">
    <p>
      ↓nの値を選択<br>
      <input type="radio" id="inq2" name="num_of_inq" value="2" required><label for="inq2">2</label><br>
      <input type="radio" id="inq3" name="num_of_inq" value="3"><label for="inq3">3</label><br>
      <input type="radio" id="inq4" name="num_of_inq" value="4"><label for="inq4">4</label><br>
      <input type="radio" id="inq5" name="num_of_inq" value="5"><label for="inq5">5</label>
    </p>
    <button type="submit">generate</button>
  </form>

  <form onsubmit="return checkAnswer(event)">
    <input type="number" id="answer-input" name="number" placeholder="xの値を入力してください" required>
    <button type="submit">ans</button>
  </form>

  <div id="output"></div>

  <script type="text/javascript">
    var modP;
    var modQ;
    var a;
    var b;
    var x;
    var n;

    function generateRandomX(event) {
      event.preventDefault();

      var num_of_inq = document.querySelector('input[name="num_of_inq"]:checked');
      n = parseInt(num_of_inq.value, 10);
      modP = Math.pow(5, n);
      modQ = Math.pow(2, n);

      x = getRandomNumber(modP * modQ);
      a = x % modP;
      b = x % modQ;

      document.getElementById('output').innerHTML = `mod(n,m) = (${modP},${modQ})<br>`;
      document.getElementById('output').innerHTML += `${a} ${b}<br>`;

      return false;
    }

    function checkAnswer(event) {
      event.preventDefault();

      var answer = parseInt(document.getElementById('answer-input').value, 10);
      var output = document.getElementById('output');

      if (answer === x) {
        output.innerHTML += 'correct！';
      } else {
        output.innerHTML += ':-(';
        output.innerHTML += `<br>answer is ${x} `;
      }

      return false;
    }

    function getRandomNumber(max) {
      return Math.floor(Math.random() * max);
    }
  </script>
</body>
</html>
